{% extends 'appstage/base.html' %}
{% load static %}
{% block title %}{{ offre.titreOffre }} | AppStage{% endblock %}

{% block main %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-10">

            <div class="card shadow-lg border-0 rounded-4 overflow-hidden animate-fade">

                <div class="row g-0">

                    <!-- IMAGE -->
                    <div class="col-md-5">
                        <img src="{% if offre.imageOffre %}{{ offre.imageOffre.url }}{% else %}{% static 'appstage/img/default_offer.jpg' %}{% endif %}"
                             class="img-fluid h-100 w-100 object-fit-cover"
                             style="min-height: 420px;"
                             alt="{{ offre.titreOffre }}">
                    </div>

                    <!-- CONTENU -->
                    <div class="col-md-7 p-4 p-lg-5 d-flex flex-column">

                        <!-- HEADER OFFRE -->
                        <div class="mb-auto">

                            <!-- Badge statut -->
                            <span class="badge
                                {% if offre.statutOffre == 'validee' %}bg-success
                                {% elif offre.statutOffre == 'refusee' %}bg-danger
                                {% else %}bg-warning text-dark{% endif %}
                                px-3 py-2 mb-3 shadow-sm">
                                {{ offre.get_statutOffre_display|default:offre.statutOffre }}
                            </span>

                            <!-- Titre -->
                            <h1 class="fw-bold h2 mb-2">{{ offre.titreOffre }}</h1>

                            <!-- Entreprise -->
                            <p class="text-primary fw-semibold fs-5 mb-4">
                                <i class="bi bi-building me-2"></i>{{ offre.entrepriseOffre }}
                            </p>

                            <!-- Description -->
                            <h5 class="fw-bold border-bottom pb-2 mb-3">Description du poste</h5>
                            <p class="text-muted" style="white-space: pre-line;">
                                {{ offre.detailsOffre }}
                            </p>
                        </div>

                        <!-- FOOTER OFFRE -->
                        <div class="mt-4 pt-4 border-top">

                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <small class="text-muted">
                                    <i class="bi bi-clock me-1"></i>
                                    Publié le {{ offre.dateDepotOffre|date:"d F Y" }}
                                </small>

                                <span class="fw-bold text-dark">
                                    <i class="bi bi-people me-1"></i>
                                    {{ offre.nb_candidatures }}/5 places
                                </span>
                            </div>

                            <!-- Bouton candidater -->
                            {% if request.user.is_authenticated and not request.user.is_staff and not request.user.is_superuser %}
                                <a href="/offres/{{ offre.IDOffre }}/candidater/"
                                   class="btn btn-primary btn-lg w-100 fw-bold shadow-sm">
                                    Déposer ma candidature
                                </a>
                            {% endif %}

                        </div>

                    </div>
                </div>

            </div>

        </div>
    </div>
</div>
{% endblock %}
